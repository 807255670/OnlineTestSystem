<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">

  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>


    <title>南京大学在线考试系统</title>
    
 
    <!---CDN Links-->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.css" rel="stylesheet"/>
    <link href="https://cdn.bootcss.com/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker3.min.css" rel="stylesheet"/>
    <!--<link href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">-->

 <link th:href="@{/css/jquery.messagetip.css}" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/css/dragtable.css}"/>
 <link rel="stylesheet" th:href="@{/css/main.css}"/>

    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
 <script src="http://code.jquery.com/jquery-migrate-1.4.1.js"></script>
 
    <script th:src="@{/scripts/tableExport/tableExport.js}"></script>
    <script th:src="@{/scripts/moment/moment.js}"></script>
 <script th:src="@{/scripts/jquery.messagetip.js}"></script>
 <script th:src="@{/scripts/jquery.dataTables.min.js}"></script>
    <script th:src="@{/scripts/dataTables.bootstrap.min.js}"></script>
    <script th:src="@{/scripts/dataTables.responsive.js}"></script>
 <script th:src="@{/scripts/dragtable/jquery.dragtable.js}"></script>
 
    <script src="https://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/extensions/export/bootstrap-table-export.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/extensions/reorder-columns/bootstrap-table-reorder-columns.js"></script>
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-datepicker/1.7.1/locales/bootstrap-datepicker.zh-CN.min.js"></script>

    
    <style>
        .fixed-table-pagination {
            padding: 0 10px
        }
        
        .input-daterange {
            width: auto
        }
    </style>

  </head>
  
  <body>
    <div class="head_admin">

    </div>
    <div class="container"><br/>
        
  <ul class="nav nav-tabs nav-justified" id="myTabs">
      <li><a href="/teacher"><strong>首  页</strong></a></li>
      <li class="active"><a href="#"><strong>导  入  试  卷</strong></a></li>
      <li><a href="/teacher/papergenerate"><strong>发  布  试  卷</strong></a></li>
      <li ><a href="/teacher/papermanager"><strong>试  卷  管  理</strong></a></li>
      <li><a href="/teacher/questionmanager"><strong>题  库  管  理</strong></a></li>
  </ul>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-md-offset-1 col-md-10">
                 <br/><br/>
                 <a>欢迎您，</a>
     <strong th:text = "${session.teachername}"></strong>
     <a>老师！</a>
     <br/><br/>
                </div>
            </div>
          </div>
          <div id="page-wrapper">
            <div class="row">
                <div class="col-md-offset-1 col-md-10">
                    <h3 class="page-header">上传题库</h3>
                    <!-- /.col-lg-12 -->
                </div>
            </div>
            <div class="row">
                <div class="col-md-offset-1 col-md-10">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            试题模版（示例）
                            <!-- <div style="float:right">
                                <a href="问题模板.xls">下载模板</a>
                            </div> -->
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th>类型</th>
                                        <th>题干</th>
                                        <th>选项A</th>
                                        <th>选项B</th>
                                        <th>选项C</th>
                                        <th>选项D</th>
                                        <th>选项E</th>
                                        <th>选项F</th>
                                        <th>答案选项</th>
                                        
                                        <th>分值</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>0(单选)</td>
                                        <td>中国有几个省份?</td>
                                        <td>20</td>
                                        <td>21</td>
                                        <td>22</td>
                                        <td>23</td>
                                        <td>24</td>
                                        <td>25</td>
                                        <td>D</td>
                                        
                                        <td>2</td>
                                    </tr>
                                    
                                    <tr>
                                        <td>1(多选)</td>
                                        <td>中国的沿海省份?</td>
                                        <td>江苏</td>
                                        <td>湖北</td>
                                        <td>浙江</td>
                                        <td>福建</td>
                                        <td>广东</td>
                                        <td>河南</td>
                                        <td>ACDE</td>
                                        
                                        <td>4</td>
                                    </tr>
                                    <tr>
                                        <td>2(判断)</td>
                                        <td>地球是行星</td>
                                        <td>正确</td>
                                        <td>错误</td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td>T</td>
                                        
                                        <td>2</td>
                                    </tr>
                                    <tr>
                                        <td>3(主观)</td>
                                        <td>你对该系统的建议有?</td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        
                                        <td>5</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            导入试题
                        </div>
                        <div class="panel-body">
                            <form role="form" action="/import" id="question_excel" method="post" enctype="multipart/form-data" >
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <input type="file" id="upfile" name="upfile" />
                                        </div>
                                    </div>
                                    <!-- <div class="col-lg-6">
                                        <button type="submit" class="btn btn-default" style="float:right" >上传文件</button>
                                    </div> -->
                                </div>
                            </form>
                            <hr/>
                            <div >
                            单选题
                        </div>
                            <div class="table-responsive" th:if="${questionList != null}">
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                    <tr>
                                        <th>类型</th>
                                        <th>题目</th>
                                        <th>选项A</th>
                                        <th>选项B</th>
                                        <th>选项C</th>
                                        <th>选项D</th>
                                        <th>选项E</th>
                                        <th>选项F</th>
                                        <th>答案</th>
                                        <th>得分</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="question:${questionList}">
                                        <td th:text="${question.getClassid()}"></td>
                                        <td th:text="${question.getBody()}"></td>
                                        <td th:text="${question.getOptiona()}"></td>
                                        <td th:text="${question.getOptionb()}"></td>
                                        <td th:text="${question.getOptionc()}"></td>
                                        <td th:text="${question.getOptiond()}"></td>
                                        <td th:text="${question.getOptione()}"></td>
                                        <td th:text="${question.getOptionf()}"></td>
                                        <td th:text="${question.getAnswer()}"></td>
                                        <td th:text="${question.getScore()}"></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- /.panel -->
                </div>
            </div>
            <div class="row">
                <div class="col-md-offset-9 col-md-2">
                   <button type="submit" class="btn btn-default submit" style="float:right" onclick="submit_question()">提交</button>
                
                </div>
            </div>
          </div>   
    </div>    
</body>

<script type="text/javascript" th:inline="JavaScript">
$(function() {
        $.ajaxSetup({
            cache: false
        }); //ajax请求不读取缓存
    })
    
    function submit_question(){
    	var questionList = [[${questionList}]];
    	//console.log(questionList[0]);
    	var data = {
    			questionList:questionList
    	}
    	
    	var jsondata = JSON.stringify(data);
    	console.log(jsondata)
    	$.ajax({
    		type:"POST",
    		url:"import/submit",
    		data:{myData:jsondata},

    		success:function(data){
    			$.messageTip.success({
    				 message:"上传成功！",
				     fadeInTimeOut : 1,   //滑入秒数
				     contentTimeOut : 3,  //内容停留秒数
				     fadeOutTimeOut : 1, ////滑出秒数
    			});
    			setTimeout(function () {
                    window.location.href = "/import";
                }, 1000);
    		},
    		error:function(XMLHttRequest,textStatus, errorThrown){
				alert(XMLHttRequest.responseText);
			}
    	});
    }
    
 </script>
     
 </html>